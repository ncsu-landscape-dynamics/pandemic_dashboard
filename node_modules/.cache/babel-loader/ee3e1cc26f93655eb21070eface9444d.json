{"ast":null,"code":"function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar SUPPORTED_LANGUAGES = ['en', 'es', 'fr', 'de', 'ru', 'zh', 'pt', 'ar', 'ja', 'ko', 'mul'];\n\nfunction getLanguageField(lang) {\n  if (lang === 'mul') {\n    return 'name';\n  }\n\n  return \"name_\".concat(lang);\n}\n\nfunction localizeTextField(field, lang) {\n  if (typeof field === 'string') {\n    return field.replace(/{name.*?}/, \"{\".concat(lang, \"}\"));\n  }\n\n  var str = JSON.stringify(field);\n\n  if (Array.isArray(field)) {\n    return JSON.parse(str.replace(/\"coalesce\",\\[\"get\",\"name.*?\"]/g, \"\\\"coalesce\\\",[\\\"get\\\",\\\"\".concat(lang, \"\\\"]\")));\n  }\n\n  return JSON.parse(str.replace(/{name.*?}/g, \"{\".concat(lang, \"}\")));\n}\n/**\n * Localize map. Language can be set dynamically with `.setLanguage(lang)` method.\n * @param {Object} options\n * @param {Array} [options.supportedLanguages] - (Supported languages)[https://docs.mapbox.com/help/troubleshooting/change-language/]\n * @param {String} [options.language] - One of the supported languages to apply\n * @param {Array} [options.excludedLayerIds=[]] - Array of layer id to exclude from localization\n * @param {Function} [options.getLanguageField] - Accepts language and returns language field\n * By default fields are `name_LANGUAGE` and `name` for multi language (mul)\n */\n\n\nvar LanguageControl = /*#__PURE__*/function () {\n  function LanguageControl() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, LanguageControl);\n\n    this.container = document.createElement('div');\n    this.supportedLanguages = options.supportedLanguages || SUPPORTED_LANGUAGES;\n    this.language = options.language;\n    this.getLanguageField = options.getLanguageField || getLanguageField;\n    this.excludedLayerIds = options.excludedLayerIds || [];\n    this.styleChangeListener = this.styleChangeListener.bind(this);\n  }\n\n  _createClass(LanguageControl, [{\n    key: \"onAdd\",\n    value: function onAdd(map) {\n      this.map = map;\n      this.map.on('styledata', this.styleChangeListener);\n      return this.container;\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove() {\n      this.map.off('styledata', this.styleChangeListener);\n      this.map = undefined;\n    }\n  }, {\n    key: \"styleChangeListener\",\n    value: function styleChangeListener() {\n      this.map.off('styledata', this.styleChangeListener);\n      this.setLanguage(this.language);\n    }\n  }, {\n    key: \"setLanguage\",\n    value: function setLanguage() {\n      var _this = this;\n\n      var lang = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.browserLanguage();\n      var language = this.supportedLanguages.indexOf(lang) < 0 ? 'mul' : lang;\n      var style = this.map.getStyle();\n      var languageField = this.getLanguageField(language);\n      var layers = style.layers.map(function (layer) {\n        if (layer.type !== 'symbol') return layer;\n        if (!layer.layout || !layer.layout['text-field']) return layer;\n        if (_this.excludedLayerIds.indexOf(layer.id) !== -1) return layer;\n        var textField = layer.layout['text-field'];\n        var textFieldLocalized = localizeTextField(textField, languageField);\n        return _objectSpread2(_objectSpread2({}, layer), {}, {\n          layout: _objectSpread2(_objectSpread2({}, layer.layout), {}, {\n            'text-field': textFieldLocalized\n          })\n        });\n      });\n      this.map.setStyle(_objectSpread2(_objectSpread2({}, style), {}, {\n        layers: layers\n      }));\n    }\n  }, {\n    key: \"browserLanguage\",\n    value: function browserLanguage() {\n      var language = navigator.languages ? navigator.languages[0] : navigator.language;\n      var parts = language.split('-');\n      var languageCode = parts.length > 1 ? parts[0] : language;\n\n      if (this.supportedLanguages.indexOf(languageCode) > -1) {\n        return languageCode;\n      }\n\n      return 'mul';\n    }\n  }]);\n\n  return LanguageControl;\n}();\n\nexport default LanguageControl;","map":{"version":3,"sources":["/Users/garrettmillar/pandemic_dashboard/node_modules/mapbox-gl-controls/lib/language.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","_defineProperty","obj","value","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","arguments","source","forEach","getOwnPropertyDescriptors","defineProperties","SUPPORTED_LANGUAGES","getLanguageField","lang","concat","localizeTextField","field","replace","str","JSON","stringify","Array","isArray","parse","LanguageControl","options","undefined","container","document","createElement","supportedLanguages","language","excludedLayerIds","styleChangeListener","bind","onAdd","map","on","onRemove","off","setLanguage","_this","browserLanguage","indexOf","style","getStyle","languageField","layers","layer","type","layout","id","textField","textFieldLocalized","setStyle","navigator","languages","parts","split","languageCode"],"mappings":"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","sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar SUPPORTED_LANGUAGES = ['en', 'es', 'fr', 'de', 'ru', 'zh', 'pt', 'ar', 'ja', 'ko', 'mul'];\n\nfunction getLanguageField(lang) {\n  if (lang === 'mul') {\n    return 'name';\n  }\n\n  return \"name_\".concat(lang);\n}\n\nfunction localizeTextField(field, lang) {\n  if (typeof field === 'string') {\n    return field.replace(/{name.*?}/, \"{\".concat(lang, \"}\"));\n  }\n\n  var str = JSON.stringify(field);\n\n  if (Array.isArray(field)) {\n    return JSON.parse(str.replace(/\"coalesce\",\\[\"get\",\"name.*?\"]/g, \"\\\"coalesce\\\",[\\\"get\\\",\\\"\".concat(lang, \"\\\"]\")));\n  }\n\n  return JSON.parse(str.replace(/{name.*?}/g, \"{\".concat(lang, \"}\")));\n}\n/**\n * Localize map. Language can be set dynamically with `.setLanguage(lang)` method.\n * @param {Object} options\n * @param {Array} [options.supportedLanguages] - (Supported languages)[https://docs.mapbox.com/help/troubleshooting/change-language/]\n * @param {String} [options.language] - One of the supported languages to apply\n * @param {Array} [options.excludedLayerIds=[]] - Array of layer id to exclude from localization\n * @param {Function} [options.getLanguageField] - Accepts language and returns language field\n * By default fields are `name_LANGUAGE` and `name` for multi language (mul)\n */\n\n\nvar LanguageControl = /*#__PURE__*/function () {\n  function LanguageControl() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, LanguageControl);\n\n    this.container = document.createElement('div');\n    this.supportedLanguages = options.supportedLanguages || SUPPORTED_LANGUAGES;\n    this.language = options.language;\n    this.getLanguageField = options.getLanguageField || getLanguageField;\n    this.excludedLayerIds = options.excludedLayerIds || [];\n    this.styleChangeListener = this.styleChangeListener.bind(this);\n  }\n\n  _createClass(LanguageControl, [{\n    key: \"onAdd\",\n    value: function onAdd(map) {\n      this.map = map;\n      this.map.on('styledata', this.styleChangeListener);\n      return this.container;\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove() {\n      this.map.off('styledata', this.styleChangeListener);\n      this.map = undefined;\n    }\n  }, {\n    key: \"styleChangeListener\",\n    value: function styleChangeListener() {\n      this.map.off('styledata', this.styleChangeListener);\n      this.setLanguage(this.language);\n    }\n  }, {\n    key: \"setLanguage\",\n    value: function setLanguage() {\n      var _this = this;\n\n      var lang = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.browserLanguage();\n      var language = this.supportedLanguages.indexOf(lang) < 0 ? 'mul' : lang;\n      var style = this.map.getStyle();\n      var languageField = this.getLanguageField(language);\n      var layers = style.layers.map(function (layer) {\n        if (layer.type !== 'symbol') return layer;\n        if (!layer.layout || !layer.layout['text-field']) return layer;\n        if (_this.excludedLayerIds.indexOf(layer.id) !== -1) return layer;\n        var textField = layer.layout['text-field'];\n        var textFieldLocalized = localizeTextField(textField, languageField);\n        return _objectSpread2(_objectSpread2({}, layer), {}, {\n          layout: _objectSpread2(_objectSpread2({}, layer.layout), {}, {\n            'text-field': textFieldLocalized\n          })\n        });\n      });\n      this.map.setStyle(_objectSpread2(_objectSpread2({}, style), {}, {\n        layers: layers\n      }));\n    }\n  }, {\n    key: \"browserLanguage\",\n    value: function browserLanguage() {\n      var language = navigator.languages ? navigator.languages[0] : navigator.language;\n      var parts = language.split('-');\n      var languageCode = parts.length > 1 ? parts[0] : language;\n\n      if (this.supportedLanguages.indexOf(languageCode) > -1) {\n        return languageCode;\n      }\n\n      return 'mul';\n    }\n  }]);\n\n  return LanguageControl;\n}();\n\nexport default LanguageControl;\n"]},"metadata":{},"sourceType":"module"}